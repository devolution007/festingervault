import{c as j,u as v,e as g,Q as _,j as e,B as d,J as x}from"./Bnixf3Ou.aae82c.js";import{u as y,h as D,D as N,a as C,L as I,b as k,c as R,d as L,e as M,f as b,g as c}from"./DRGtvNdL.aae82c.js";import{a as E}from"./Cb9GmOKG.aae82c.js";/**
 * @license lucide-react v0.396.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=j("CloudDownload",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m8 17 4 4 4-4",key:"1ul180"}]]);function P(i,A){const u=v(),h=E(),o=React.useMemo(()=>["wordpress-themes","wordpress-plugins"].includes(i.type),[i]),{isPending:p,mutateAsync:w}=y("item/install"),{data:s}=D(),{list:l}=g(),n=React.useMemo(()=>l==null?void 0:l.find(t=>t.id===i.id),[l]),a=React.useMemo(()=>{if(n)return _(n.version,n.installed_version,"gt")===!0},[n,l]);function m(t){if(typeof(s==null?void 0:s.plan_type)>"u"){x.error(wp.i18n.__("License not activated")),h("/activation");return}x.promise(w({item_id:i.id,method:t===!0?"download":"install"}),{description:wp.htmlEntities.decodeEntities(i.title),loading:t===!0?"Downloading":n?a?"Updating":"Re-Installing":"Installing",success(r){return r.link&&t===!0&&window.open(r.link,"_blank"),u.invalidateQueries({queryKey:["update/list"]}),u.invalidateQueries({queryKey:["item/detail"]}),wp.i18n.__("Successful")},error(r){return r.message}})}function f(){return e.jsxs(N,{children:[e.jsx(C,{asChild:!0,children:e.jsxs(d,{variant:"default",size:"sm",className:"flex items-center gap-2",disabled:p,children:[e.jsx(U,{width:16}),e.jsx("span",{children:o?n?a?"Update":"Re-Install":"Install":"Download"}),p?e.jsx(I,{className:"h-4 w-4 animate-spin"}):null]})}),e.jsx(k,{children:e.jsxs("div",{className:"mx-auto w-full max-w-sm",children:[e.jsxs(R,{className:"text-center",children:[e.jsx(L,{className:"text-center leading-normal",children:wp.htmlEntities.decodeEntities(i.title)}),e.jsx(M,{className:"flex flex-col gap-2 text-center",asChild:!0,children:e.jsxs("div",{children:[e.jsx("div",{children:o?n?a?wp.i18n.sprintf("Update version from %s to %s",n.installed_version,n.version):wp.i18n.sprintf(wp.i18n.__("Re-install version %s"),n.version):wp.i18n.sprintf("Install version %s",i.version):wp.i18n.sprintf("Download version %s",i.version)}),e.jsx("div",{children:wp.i18n.sprintf(wp.i18n.__("%d download credit would be consumed from your account."),1)}),e.jsxs("div",{className:"flex flex-row justify-center gap-2 divide-x",children:[e.jsxs("div",{className:"px-4",children:["Daily Limit: ",s==null?void 0:s.today_limit]}),e.jsxs("div",{className:"px-4",children:["Used Limit: ",s==null?void 0:s.today_limit_used]}),(s==null?void 0:s.plan_title)==="recurring"&&e.jsxs("div",{className:"p-4",children:["Total Limit: ",s==null?void 0:s.total_limit]})]})]})})]}),e.jsx(b,{children:e.jsxs("div",{className:"flex flex-row justify-center gap-4",children:[o&&e.jsx(c,{asChild:!0,children:e.jsx(d,{onClick:()=>m(!1),variant:"default",className:"gap-2",children:e.jsx("span",{children:n?a?"Update":"Re-Install":"Install"})})}),e.jsx(c,{asChild:!0,children:e.jsx(d,{onClick:()=>m(!0),variant:"default",className:"gap-2",children:e.jsx("span",{children:wp.i18n.__("Download")})})}),e.jsx(c,{asChild:!0,children:e.jsx(d,{variant:"outline",children:wp.i18n.__("Cancel")})})]})})]})})]})}return{isInstalled:n,isNewerVersion:a,InstallButton:f}}export{P as u};
