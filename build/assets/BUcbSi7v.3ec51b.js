import{u as m,e as f,j as e,B as r,v as _,J as h}from"./ChQuhNz2.3ec51b.js";import{u as g,D as j,a as v,L as D,b as I,c as C,d as y,e as d,f as N,g as k}from"./CziVnfbL.3ec51b.js";function P(n){const c=m(),[p,l]=React.useState(!1),a=["wordpress-themes","wordpress-plugins"].includes(n.type),{isPending:o,mutateAsync:u}=g("item/install"),{list:i}=f(),s=React.useMemo(()=>i==null?void 0:i.find(t=>t.id===n.id),[i]);function w(){l(!1),h.promise(u({item_id:n.id,method:s?"update":"install"}),{description:wp.htmlEntities.decodeEntities(n.title),loading:a?s?"Updating":"Installing":"Downloading",success(t){return t.link&&n.type=="elementor-template-kits"&&window.open(t.link,"_blank"),c.invalidateQueries({queryKey:["update/list"]}),wp.i18n.__("Successful")},error(t){return wp.i18n.__("Error")}})}function x(){return e.jsxs(j,{open:p,onOpenChange:l,children:[e.jsx(v,{asChild:!0,children:e.jsxs(r,{variant:"default",size:"sm",className:"flex items-center gap-2",disabled:o,onClick:t=>{l(!0)},children:[e.jsx("span",{children:a?s?_(s.version,s.installed_version,"gt")===!0?"Update":"Re-Install":"Install":"Download"}),o?e.jsx(D,{className:"h-4 w-4 animate-spin"}):null]})}),e.jsx(I,{children:e.jsxs("div",{className:"mx-auto w-full max-w-sm",children:[e.jsxs(C,{className:"text-center",children:[e.jsx(y,{className:"text-center leading-normal",children:`${s?wp.i18n.__("Update"):"Install"} ${wp.htmlEntities.decodeEntities(n.title)}`}),e.jsx(d,{className:"flex flex-col gap-2 text-center",children:a?s?wp.i18n.sprintf("Update version from %s to %s",s.installed_version,s.version):wp.i18n.sprintf("Install version %s",n.version):wp.i18n.sprintf("Download version %s",n.version)}),e.jsx(d,{className:"flex flex-col gap-2 text-center",children:wp.i18n.sprintf(wp.i18n.__("%s would consume %d download credit from your account."),a?s?wp.i18n.__("Update"):wp.i18n.__("Install"):wp.i18n.__("Download"),n.owned?0:1)})]}),e.jsx(N,{children:e.jsxs("div",{className:"flex flex-row justify-center gap-4",children:[e.jsx(r,{onClick:w,variant:"default",className:"gap-2",children:e.jsx("span",{children:a?s?wp.i18n.__("Update"):wp.i18n.__("Install"):wp.i18n.__("Download")})}),e.jsx(k,{asChild:!0,children:e.jsx(r,{variant:"outline",children:wp.i18n.__("Cancel")})})]})})]})})]})}return{isInstalled:s,InstallButton:x}}export{P as u};
