import{c as j,r as h,f as k,Z as m,u as I,j as s,B as r,J as y}from"./DycBHW-b.3381b5.js";import{h as N,u as R,D as M,a as b,L as B,b as L,c as E,d as U,e as A,f as P,g as x}from"./BQx8r2V5.3381b5.js";import{a as H,u as T}from"./DimoGqCZ.3381b5.js";/**
 * @license lucide-react v0.396.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=j("CloudDownload",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m8 17 4 4 4-4",key:"1ul180"}]]);/**
 * @license lucide-react v0.396.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=j("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.396.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=j("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function J(l,n){const o=h.useMemo(()=>["wordpress-themes","wordpress-plugins"].includes(l.type),[l]),{list:a}=k(),i=h.useMemo(()=>a==null?void 0:a.find(f=>f.id===l.id),[a]),e=h.useMemo(()=>i?m(i.version,i.installed_version,"gt")===!0:!1,[i,a]),d=h.useMemo(()=>i&&n?m(i.installed_version,n.version,"gt")===!0:!1,[i,n]);return{isInstalled:i,isNewerVersion:e,isInstallable:o,isRollBack:d}}function S({item:l,media:n,size:o,variant:a}){const i=H(),{data:e}=N();I();const{isPending:d,mutateAsync:f}=R("item/install"),{isInstalled:t,isNewerVersion:c,isInstallable:v,isRollBack:p}=J(l,n),{clearCache:D}=k(),{tab:C}=T("/item/:type/detail/:id/:tab?");function g(w){if(typeof(e==null?void 0:e.plan_type)>"u"){y.error(wp.i18n.__("License not activated","festingervault")),i("/activation");return}y.promise(f({item_id:l.id,method:w===!0?"download":"install",media_id:n==null?void 0:n.id}),{description:wp.htmlEntities.decodeEntities(l.title),loading:w===!0?"Downloading":p?wp.i18n.sprintf("Roll-Back to version %s",n.version):t?c?"Updating":"Re-Installing":"Installing",success(u){return u.link&&w===!0&&window.open(u.link,"_blank"),D(),wp.i18n.__("Successful","festingervault")},error(u){return u.message}})}return s.jsxs(M,{children:[s.jsx(b,{asChild:!0,children:s.jsxs(r,{variant:a,size:o,className:"flex items-center gap-2",disabled:d,children:[d?s.jsx(B,{className:"h-4 w-4 animate-spin"}):s.jsx(_,{width:16}),o!="icon"&&s.jsx("span",{children:v?p?"Roll-Back":t?c?"Update":"Re-Install":"Install":"Download"})]})}),s.jsx(L,{children:s.jsxs("div",{className:"mx-auto w-full max-w-sm",children:[s.jsxs(E,{className:"text-center",children:[s.jsx(U,{className:"text-center leading-normal",children:wp.htmlEntities.decodeEntities(l.title)}),s.jsx(A,{className:"flex flex-col gap-2 text-center",asChild:!0,children:s.jsxs("div",{children:[s.jsx("div",{children:v?p?wp.i18n.sprintf("Roll-back to version from %s to %s",t.installed_version,n.version):t?c?wp.i18n.sprintf("Update version from %s to %s",t.installed_version,t.version):wp.i18n.sprintf(wp.i18n.__("Re-install version %s","festingervault"),n?n.version:t.version):wp.i18n.sprintf("Install version %s",n?n.version:l.version):wp.i18n.sprintf("Download version %s",n?n.version:l.version)}),s.jsx("div",{children:wp.i18n.sprintf(wp.i18n.__("%d download credit would be consumed from your account."),1)}),s.jsxs("div",{className:"flex flex-row justify-center divide-x",children:[s.jsxs("div",{className:"px-4",children:["Daily Limit: ",e==null?void 0:e.today_limit]}),s.jsxs("div",{className:"px-4",children:["Used Limit: ",e==null?void 0:e.today_limit_used]}),(e==null?void 0:e.plan_title)==="recurring"&&s.jsxs("div",{className:"p-4",children:["Total Limit: ",e==null?void 0:e.total_limit]})]})]})})]}),s.jsx(P,{children:s.jsxs("div",{className:"flex flex-row justify-center gap-4",children:[v&&s.jsx(x,{asChild:!0,children:s.jsxs(r,{onClick:()=>g(!1),variant:"default",className:"gap-2",children:[s.jsx(_,{size:16}),s.jsx("span",{children:p?"Roll-Back":t?c?"Update":"Re-Install":"Install"})]})}),s.jsx(x,{asChild:!0,children:s.jsxs(r,{onClick:()=>g(!0),variant:"outline",className:"gap-2",children:[s.jsx(q,{size:16}),s.jsx("span",{children:wp.i18n.__("Download","festingervault")})]})}),C!=="changelog"&&s.jsx(x,{asChild:!0,children:s.jsxs(r,{onClick:()=>i("/item/:type/detail/:id/:tab?",{params:{type:l.type,id:l.id,tab:"changelog"}}),variant:"outline",className:"gap-2",children:[s.jsx(z,{size:16}),s.jsx("span",{children:wp.i18n.__("Roll-Back","festingervault")})]})}),s.jsx(x,{asChild:!0,children:s.jsx(r,{variant:"outline",children:wp.i18n.__("Cancel","festingervault")})})]})})]})})]})}export{_ as C,q as D,S as I,J as u};
